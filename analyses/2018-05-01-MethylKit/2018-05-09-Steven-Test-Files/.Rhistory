#### INSTALL METHYLKIT ####
source("https://bioconductor.org/biocLite.R") #Source package from bioconductor
biocLite("methylKit")
biocLite("methylKit")
library(methylKit)
#### INSTALL METHYLKIT ####
install.packages("devtools") #Install the devtools package
source("https://bioconductor.org/biocLite.R") #Source package from bioconductor
biocLite("methylKit") #Install methylkit
library(methylKit) #Load methylkit
setwd("../2018-04-27-Bismark/") #Set working directory as bismark folder
analysisFiles <- list ("zr2096_1_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_2_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_3_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_4_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_5_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_6_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_7_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_8_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_9_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_10_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam")
sample.IDs <- 1:10
processedFiles <- processBismarkAln(location = analysisFiles, sample.id = sample.IDs, assembly = "v3", read.context = "CpG", mincov = 1, treatment = c(rep(0, times = 5)), rep(1, times = 5)) #Process files for CpG meetehylation. First 5 files were from ambient conditionds, and the second from high pCO2 conditions.
sample.IDs <- list(1:10) #Create vector of sample IDs
View(sample.IDs)
sample.IDs <- list("1", "2", "3", "4", "5", "6", "7", "8", "9", "10") #Create vector of sample IDs
processedFiles <- processBismarkAln(location = analysisFiles, sample.id = sample.IDs, assembly = "v3", read.context = "CpG", mincov = 1, treatment = c(rep(0, times = 5)), rep(1, times = 5)) #Process files for CpG meetehylation. First 5 files were from ambient conditionds, and the second from high pCO2 conditions.
treatmentSpecification <- c(rep(0, times = 5), rep(1, times = 5))
processedFiles <- processBismarkAln(location = analysisFiles, sample.id = sample.IDs, assembly = "v3", read.context = "CpG", mincov = 1, treatment = treatmentSpecification) #Process files for CpG meetehylation. First 5 files were from ambient conditionds, and the second from high pCO2 conditions.
#### ANALYZE METHYLATION DATA ####
getMethylationStats(processedFiles[[1]], plot=FALSE, both.strands=FALSE) #Get methylation information
getMethylationStats(processedFiles[[1]], plot=TRUE, both.strands=FALSE) #Plot methylation information
getCoverageStats(processedFiles[[4]], plot=TRUE, both.strands=FALSE) #Get coverage information
methylationInformation <- unite(processedFiles)
View(methylationInformation)
getCorrelation(methylationInformation,plot=TRUE)
?unite
unite(processedFiles)
methylationInformation <- unite(processedFiles)
View(processedFiles)
getCoverageStats(processedFiles[[4]], plot=TRUE, both.strands=FALSE) #Get coverage information
getCoverageStats(processedFiles[[4]], plot = TRUE, both.strands = FALSE) #Get coverage information
getCoverageStats(processedFiles[[1]], plot = TRUE, both.strands = FALSE) #Get coverage information
#### ANALYZE METHYLATION DATA ####
getMethylationStats(processedFiles[[1]], plot = FALSE, both.strands = FALSE) #Get methylation information for the first data file
#### ANALYZE METHYLATION DATA ####
getMethylationStats(processedFiles[[1]], plot = TRUE, both.strands = FALSE) #Plot methylation information for the first file
getCoverageStats(processedFiles[[1]], plot = TRUE, both.strands = FALSE) #Get coverage information for the first file
#### ANALYZE METHYLATION DATA ####
nFiles <- length(sample.IDs)
getMethylationStats(processedFiles[[1]], plot = TRUE, both.strands = FALSE) #Plot methylation information
getCoverageStats(processedFiles[[1]], plot = TRUE, both.strands = FALSE) #Get coverage information
fileName <- data.frame("nameBase" = rep("2018-05-08-Percent-CpG-Methylation", times = nFiles),
"sample.ID" = sample.IDs) #Create new dataframe for filenames
head(fileName)
fileName <- data.frame("nameBase" = rep("2018-05-08-Percent-CpG-Methylation", times = nFiles),
"sample.ID" = 1:10) #Create new dataframe for filenames
head(fileName)
fileName$actualFileName <- paste(fileName$nameBase, fileName$sample.ID, ".jpeg", sep = "") #Create a new column for the full filename
head(fileName) #Confirm column creation
fileName$actualFileName <- paste(fileName$nameBase, "-Sample", fileName$sample.ID, ".jpeg", sep = "") #Create a new column for the full filename
head(fileName) #Confirm column creation
for(i in 1:nFiles) { #For each data file
jpeg(filename = fileName$actualFileName[i], height = 1000, width = 1000) #Save file with designated name
getMethylationStats(processedFiles[[i]], plot = TRUE, both.strands = FALSE) #Get %CpG methylation information
dev.off() #Turn off plotting device
} #Plot and save %CpG methylation information
fileName <- data.frame("nameBase" = rep("2018-05-08-Percent-CpG-Methylation", times = nFiles),
"nameBase2" = rep("2018-05-08-Percent-CpG-Coverage", times = nFiles),
"sample.ID" = 1:10) #Create new dataframe for filenames
head(fileName) #Confirm dataframe creation
fileName$actualFileName2 <- paste(fileName$nameBase2, "-Sample", fileName$sample.ID, ".jpeg", sep = "") #Create a new column for the full filename
head(fileName) #Confirm column creation
for(i in 1:nFiles) { #For each data file
jpeg(filename = fileName$actualFileName[i], height = 1000, width = 1000) #Save file with designated name
getCoverageStats(processedFiles[[i]], plot = TRUE, both.strands = FALSE) #Get CpG coverage information
dev.off() #Turn off plotting device
} #Plot and save CpG coverage information
unite(processedFiles)
methylationInformation <- unite(processedFiles)
unite(processedFiles)
setwd("../2018-04-27-Bismark/") #Set working directory as bismark folder
#### INSTALL PACKAGES ####
install.packages("devtools") #Install the devtools package
library(devtools) #Load devtools
source("https://bioconductor.org/biocLite.R") #Source package from bioconductor
biocLite("methylKit") #Install methylkit
library(methylKit) #Load methylkit
install_github("al2na/methylKit", build_vignettes=FALSE,
repos=BiocInstaller::biocinstallRepos(),
dependencies=TRUE) #Install more methylKit options
analysisFiles <- list ("zr2096_1_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_2_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_3_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_4_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_5_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_6_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_7_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_8_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_9_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_10_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam") #Put all .bam files into a list for analysis
sample.IDs <- list("1", "2", "3", "4", "5", "6", "7", "8", "9", "10") #Create list of sample IDs
treatmentSpecification <- c(rep(0, times = 5), rep(1, times = 5))
processedFiles <- processBismarkAln(location = analysisFiles, sample.id = sample.IDs, assembly = "v3", read.context = "CpG", mincov = 1, treatment = treatmentSpecification) #Process files for CpG meetehylation. First 5 files were from ambient conditionds, and the second from high pCO2 conditions.
processedFiles <- processBismarkAln(location = analysisFiles, sample.id = sample.IDs, assembly = "v3", read.context = "CpG", mincov = 1, treatment = treatmentSpecification) #Process files for CpG meetehylation. First 5 files were from ambient conditionds, and the second from high pCO2 conditions.
#### INSTALL PACKAGES ####
install.packages("devtools") #Install the devtools package
install.packages("devtools")
library(devtools) #Load devtools
source("https://bioconductor.org/biocLite.R") #Source package from bioconductor
biocLite("methylKit") #Install methylkit
install_github("al2na/methylKit", build_vignettes = FALSE, repos=BiocInstaller::biocinstallRepos(), dependencies = TRUE) #Install more methylKit options
library(methylKit) #Load methylkit
#### SET WORKING DIRECTORY ####
getwd()
setwd("../2018-04-27-Bismark/") #Set working directory as bismark folder
#### SET WORKING DIRECTORY ####
getwd()
analysisFiles <- list ("zr2096_1_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_2_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_3_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_4_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_5_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_6_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_7_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_8_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_9_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam",
"zr2096_10_s1_R1_bismark_bt2_pe.deduplicated.sorted.bam") #Put all .bam files into a list for analysis
sample.IDs <- list("1", "2", "3", "4", "5", "6", "7", "8", "9", "10") #Create list of sample IDs
treatmentSpecification <- c(rep(0, times = 5), rep(1, times = 5))
processedFiles <- processBismarkAln(location = analysisFiles, sample.id = sample.IDs, assembly = "v3", read.context = "CpG", mincov = 1, treatment = treatmentSpecification) #Process files for CpG meetehylation. First 5 files were from ambient conditionds, and the second from high pCO2 conditions.
setwd("../2018-05-01-MethylKit/") #Chance working directory to the MethylKit folder
getwd() #Confirm change
nFiles <- length(sample.IDs) #Count number of samples
fileName <- data.frame("nameBase" = rep("2018-05-08-Percent-CpG-Methylation", times = nFiles),
"nameBase2" = rep("2018-05-08-Percent-CpG-Coverage", times = nFiles),
"sample.ID" = 1:10) #Create new dataframe for filenames
head(fileName) #Confirm dataframe creation
fileName$actualFileName <- paste(fileName$nameBase, "-Sample", fileName$sample.ID, ".jpeg", sep = "") #Create a new column for the full filename
fileName$actualFileName2 <- paste(fileName$nameBase2, "-Sample", fileName$sample.ID, ".jpeg", sep = "") #Create a new column for the full filename
head(fileName) #Confirm column creation
for(i in 1:nFiles) { #For each data file
jpeg(filename = fileName$actualFileName[i], height = 1000, width = 1000) #Save file with designated name
getMethylationStats(processedFiles[[i]], plot = TRUE, both.strands = FALSE) #Get %CpG methylation information
dev.off() #Turn off plotting device
} #Plot and save %CpG methylation information
for(i in 1:nFiles) { #For each data file
jpeg(filename = fileName$actualFileName[i], height = 1000, width = 1000) #Save file with designated name
getCoverageStats(processedFiles[[i]], plot = TRUE, both.strands = FALSE) #Get CpG coverage information
dev.off() #Turn off plotting device
} #Plot and save CpG coverage information
methylationInformation <- unite(processedFiles)
View(methylationInformation)
methylationInformation <- unite(processedFiles) #Combine all processed files into a single table
unite(processedFiles)
methylationInformation <- unite(processedFiles) #Combine all processed files into a single table
View(methylationInformation)
?getCorrelation
?clusterSamples
?PCASamples
?calculateDiffMeth
?getMethylDiff
?unite
for(i in 1:nFiles) { #For each data file
jpeg(filename = fileName$actualFileName[i], height = 1000, width = 1000) #Save file with designated name
getMethylationStats(processedFiles[[i]], plot = TRUE, both.strands = FALSE) #Get %CpG methylation information
dev.off() #Turn off plotting device
} #Plot and save %CpG methylation information
for(i in 1:nFiles) { #For each data file
jpeg(filename = fileName$actualFileName2[i], height = 1000, width = 1000) #Save file with designated name
getCoverageStats(processedFiles[[i]], plot = TRUE, both.strands = FALSE) #Get CpG coverage information
dev.off() #Turn off plotting device
} #Plot and save CpG coverage information
#### SET WORKING DIRECTORY ####
getwd()
setwd("2018-05-08-Steven-Test-Files/") #Set working directory as test file folder
#### SET WORKING DIRECTORY ####
getwd()
setwd("2018-05-08-Steven-Test-Files/") #Set working directory as test file folder
#### INSTALL PACKAGES ####
install.packages("devtools") #Install the devtools package
install.packages("devtools")
library(devtools) #Load devtools
source("https://bioconductor.org/biocLite.R") #Source package from bioconductor
biocLite("methylKit") #Install methylkit
install_github("al2na/methylKit", build_vignettes = FALSE, repos=BiocInstaller::biocinstallRepos(), dependencies = TRUE) #Install more methylKit options
library(methylKit) #Load methylkit
analysisFiles <- list ("zr2096_9_dedup.sorted.bam",
"zr2096_10_dedup.sorted.bam") #Put all .bam files into a list for analysis
analysisFiles <- list ("zr2096_1_dedup.sorted.bam",
"zr2096_10_dedup.sorted.bam") #Put all .bam files into a list for analysis
sample.IDs <- list("1", "10") #Create list of sample IDs
treatmentSpecification <- c(0, 1)
processedFiles <- processBismarkAln(location = analysisFiles, sample.id = sample.IDs, assembly = "v3", read.context = "CpG", mincov = 1, treatment = treatmentSpecification) #Process files for CpG meetehylation. First 5 files were from ambient conditionds, and the second from high pCO2 conditions.
nFiles <- length(sample.IDs) #Count number of samples
#### SET WORKING DIRECTORY ####
getwd()
library(devtools) #Load devtools
library(methylKit) #Load methylkit
analysisFiles <- list ("zr2096_1_dedup.sorted.bam",
"zr2096_10_dedup.sorted.bam") #Put all .bam files into a list for analysis
sample.IDs <- list("1", "10") #Create list of sample IDs
treatmentSpecification <- c(0, 1)
processedFiles <- processBismarkAln(location = analysisFiles, sample.id = sample.IDs, assembly = "v3", read.context = "CpG", mincov = 1, treatment = treatmentSpecification) #Process files for CpG meetehylation. First 5 files were from ambient conditionds, and the second from high pCO2 conditions.
nFiles <- length(sample.IDs) #Count number of samples
fileName <- data.frame("nameBase" = rep("2018-05-08-Percent-CpG-Methylation", times = nFiles),
"nameBase2" = rep("2018-05-08-Percent-CpG-Coverage", times = nFiles),
"sample.ID" = 1:10) #Create new dataframe for filenames
head(fileName) #Confirm dataframe creation
fileName$actualFileName <- paste(fileName$nameBase, "-Sample", fileName$sample.ID, ".jpeg", sep = "") #Create a new column for the full filename
fileName$actualFileName2 <- paste(fileName$nameBase2, "-Sample", fileName$sample.ID, ".jpeg", sep = "") #Create a new column for the full filename
head(fileName) #Confirm column creation
for(i in 1:nFiles) { #For each data file
jpeg(filename = fileName$actualFileName[i], height = 1000, width = 1000) #Save file with designated name
getMethylationStats(processedFiles[[i]], plot = TRUE, both.strands = FALSE) #Get %CpG methylation information
dev.off() #Turn off plotting device
} #Plot and save %CpG methylation information
for(i in 1:nFiles) { #For each data file
jpeg(filename = fileName$actualFileName2[i], height = 1000, width = 1000) #Save file with designated name
getCoverageStats(processedFiles[[i]], plot = TRUE, both.strands = FALSE) #Get CpG coverage information
dev.off() #Turn off plotting device
} #Plot and save CpG coverage information
methylationInformation <- unite(processedFiles) #Combine all processed files into a single table
getCorrelation(methylationInformation, plot = TRUE) #Understand correlation between methylation patterns in different samples
getCorrelation(methylationInformation, plot = FALSE) #Understand correlation between methylation patterns in different samples
getCorrelation(methylationInformation, plot = TRUE) #Understand correlation between methylation patterns in different samples
clusterSamples(methylationInformation, dist = "correlation", method = "ward", plot = TRUE) #Cluster samples based on correlation coefficients
clusteringInformation <- clusterSamples(methylationInformation, dist = "correlation", method = "ward", plot = FALSE) #Save cluster information as a new object
clusterSamples(methylationInformation, dist = "correlation", method = "ward.D", plot = TRUE) #Cluster samples based on correlation coefficients
clusterSamples(methylationInformation, dist = "correlation", method = "ward.D2", plot = TRUE) #Cluster samples based on correlation coefficients
clusterSamples(methylationInformation, dist = "correlation", method = "ward", plot = TRUE) #Cluster samples based on correlation coefficients
clusteringInformation <- clusterSamples(methylationInformation, dist = "correlation", method = "ward", plot = FALSE) #Save cluster information as a new object
View(clusteringInformation)
PCASamples(methylationInformation) #Run a PCA analysis on percent methylation for all samples
PCASamples(methylationInformation, screeplot = TRUE) #Run the PCA analysis and plot variances against PC number in a screeplot
differentialMethylationStats <- calculateDiffMeth(methylationInformation) #Calculate differential methylation statistics based on treatment indication from processBismarkAln
diffMethStats25 <- getMethylDiff(differentialMethylationStats, difference = 25, qvalue = 0.01) #Identify loci that are at least 25% different
View(diffMethStats25)
View(differentialMethylationStats)
diffMethStats50 <- getMethylDiff(differentialMethylationStats,difference=50,qvalue=0.01) #Identify loci that are at least 50% different
View(diffMethStats25)
?getMethylDiff
